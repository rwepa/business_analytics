---
format:
  revealjs: 
    theme: default
    menu: true
    slide-number: true
    code-line-numbers: true
    code-overflow: wrap
    code-block-bg: true
editor: visual
---

##  {background-video="images/r-shiny-03-layout_title.mp4"}

## å¤§ç¶±

3.1 ä½ˆç½®å‡½æ•¸ç¸½è¦½

3.2 tabsetPanel(åˆ†é é¢ç‰ˆ)

3.3 shinyå„€è¡¨æ¿æ¨™æº–æµç¨‹

3.4 ç¬¬2ç« ç¿’é¡Œè§£ç­”

3.5 ç¿’é¡Œ

3.6 çµè«–

## 3.1 ä½ˆç½®å‡½æ•¸ç¸½è¦½

-   Shiny RStudio \\ Reference \\ Latest version -\> <a href="https://shiny.rstudio.com/reference/shiny/1.7.4/" target="_blank">Shiny v1.7.4</a>

![](images/shiny_function_reference.png)

## shinyä½ˆç½®å‡½æ•¸ç¸½è¡¨(1/2)

```{r}
library(kableExtra)
df <- read.table(header=TRUE, sep = ",", text="
ä½ˆç½®å‡½æ•¸, ä¸»é¡Œ, ä¸­æ–‡
1.absolutePanel() and fixedPanel(), Panel with absolute positioning, çµ•å°ä½ç½®é¢æ¿
2.bootstrapPage() and basicPage(), Create a Bootstrap page, å»ºç«‹Bootstrapæ¡†æ¶é é¢
3.column(), Create a column within a UI definition, å»ºç«‹å¤šè¡ŒUI
4.conditionalPanel(), Conditional Panel, æ¢ä»¶å¼é¢æ¿
5.fillPage(), Create a page that fills the window, å¡«å……é¢æ¿
6.fillRow() and fillCol(), Flex Box-based row/column layouts, å½ˆæ€§åˆ—/è¡Œé¢æ¿
7.fixedPage() and fixedRow(), Create a page with a fixed layout, å›ºå®šé¢æ¿
8.fluidPage() and fluidRow(), *Create a page with fluid layout, æµå‹•é¢æ¿
9.helpText(), Create a help text element, èªªæ˜é¢æ¿
10.icon(), Create an icon, å»ºç«‹æŒ‰éˆ•
11.navbarPage() and navbarMenu(), Create a page with a top level navigation bar, ç€è¦½é¢ç‰ˆèˆ‡ç€è¦½ä¸‹æ‹‰é¸å–®(é©åˆå·¦å´ä¸åŒ)
12.navlistPanel(), Create a navigation list panel, ç€è¦½ä¸²åˆ—é¢ç‰ˆ
")
df %>%
  kbl(format = 'html') %>%
  kable_classic("hover", full_width = FALSE) %>%
  kable_styling(font_size = 24)
```

## shinyä½ˆç½®å‡½æ•¸ç¸½è¡¨(2/2)

```{r}
library(kableExtra)
df <- read.table(header=TRUE, sep = ",", text="
ä½ˆç½®å‡½æ•¸ , ä¸»é¡Œ, ä¸­æ–‡    
13.sidebarLayout() and sidebarPanel() and mainPanel(), Layout a sidebar and main area, *å´é‚Šé¢æ¿
14.tabPanel() and tabPanelBody(), Create a tab panel, *åˆ†é é¢ç‰ˆ
15.tabsetPanel(), Create a tabset panel, *åˆ†é é›†åˆé¢ç‰ˆ(é©åˆå·¦å´ç›¸åŒ)
16.titlePanel(), Create a panel containing an application title, æ¨™é¡Œé¢æ¿
17.inputPanel(), Input panel, è¼¸å…¥é¢æ¿
18.flowLayout(), Flow layout, æµç¨‹ä½ˆç½®
19.splitLayout(), Split layout, åˆ†å‰²ä½ˆç½®
20.verticalLayout(), Lay out UI elements vertically, å‚ç›´ä½ˆç½®
21.wellPanel(), Create a well panel, å»ºç«‹ Well é¢æ¿
22.withMathJax(), Load the MathJax library and typeset math expressions, æ•¸å­¸å¼
")
df %>%
  kbl(format = 'html') %>%
  kable_classic("hover", full_width = FALSE) %>%
  kable_styling(font_size = 24)
```

## 3.2 tabsetPanel(é¸å–®é¢ç‰ˆ)

::: columns
::: {.column width="50%"}
-   sidebarLayout(å´é‚Šé¢æ¿)

```{r}
#| eval: false
#| echo: true
library(shiny)
runExample("02_text")
```

![](images/sidebarLayout.png)
:::

::: {.column width="50%"}
-   tabsetPanel(é¸å–®é¢ç‰ˆ)

```{r}
#| eval: false
#| echo: true
# å»ºç«‹ tabsetPanel, 2å€‹ tabPanel
# ä¿®æ”¹ç¨‹å¼ç¢¼ğŸ°
```

![](images/tabsetPanelLayout.png)
:::
:::

## Shiny Text-tabsetPanel

-   <a href="https://github.com/rwepa/business_analytics/blob/main/r-shiny-03-layout/r-code/r-shiny-03-layout.R" target="_blank">https://github.com/rwepa/business_analytics/blob/main/r-shiny-03-layout/r-code/r-shiny-03-layout.R</a>

```{r}
#| eval: false
#| echo: true
# å»ºç«‹ tabsetPanel, 2å€‹ tabPanel
mainPanel(
      
      # å»ºç«‹ tabsetPanel, åŒ…æ‹¬2å€‹ tabPanel
      tabsetPanel(
        
        tabPanel("è³‡æ–™æ‘˜è¦", verbatimTextOutput("summary")),
        
        tabPanel("è¡¨æ ¼", tableOutput("table"))
        
      )
)
```

-   ç·´ç¿’ runExample("06_tabsets")

## 3.3 shinyå„€è¡¨æ¿æ¨™æº–æµç¨‹

1.  éœ€æ±‚ç¢ºèª: ç›®æ¨™, ä½¿ç”¨è€…(ç­–ç•¥, æˆ°è¡“, æ“ä½œ), æ›´æ–°æ™‚é–“, å°ˆæ¡ˆæœŸé™, é ç®—, å°ˆæ¡ˆç¶“ç†

2.  è³‡æ–™ETL(Extract, Transform, Load): ä¼æ¥­å…§éƒ¨, å¤–éƒ¨è³‡æ–™, å…è²», ä»˜è²», è³‡æ–™åº«, é›²ç«¯

3.  å»ºç«‹å„€è¡¨æ¿: é››å‹, é¸å–é©ç•¶å¥—ä»¶(graphics, ggplot2, plotly, gganimate, leaflet)

4.  æ¸¬è©¦: è³‡æ–™, åŠŸèƒ½

5.  ä½ˆç½²èˆ‡æ–‡ä»¶è£½ä½œ

## 3.4 ç¬¬2ç« ç¿’é¡Œè§£ç­”

-   <a href="https://github.com/rwepa/business_analytics/blob/main/r-shiny-03-layout/r-code/r-shiny-02-exercise-solution.R" target="_blank">https://github.com/rwepa/business_analytics/blob/main/r-shiny-03-layout/r-code/r-shiny-02-exercise-solution.R</a>

```{r}
#| eval: false
#| echo: true
# æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦æœ‰é¸å–è®Šæ•¸,å¦‚æœæ²’æœ‰é¸å–, ä»¥ä¸‹ç¨‹å¼ä¸æœƒåŸ·è¡Œ
req(input$variable)

# è§£æé¸å–çš„è®Šæ•¸
# x <- input$variable # çµæœæœƒæœ‰Error
x <- eval(parse(text = paste0("iris$", input$variable)))
bins <- seq(from = min(x),
            to = max(x),
            length.out = input$bins + 1)
```

## 3.5 ç¿’é¡Œ OnlineRetail.xlsx è³‡æ–™é›† {.smaller}

-   <a href="https://github.com/rwepa/DataDemo/blob/master/OnlineRetail.xlsx" target="_blank">https://github.com/rwepa/DataDemo/blob/master/OnlineRetail.xlsx</a>

-   è³‡æ–™ç­†æ•¸: 541909, æ¬„ä½å€‹æ•¸: 8

-   ä½¿ç”¨ readxl å¥—ä»¶ åŒ¯å…¥ Excel æª”æ¡ˆä¸¦å»ºç«‹4å€‹åˆ†é é¢æ¿

![](images/OnlineRetail.png)
## 3.5 ç¿’é¡Œ - shiny æ¶æ§‹ 

::: {style="font-size: 0.6em"}

-   ui:

    -   ä½¿ç”¨ tabsetPanel + sidebarLayout ä½ˆç½®æ–¹å¼.

    -   ä»¥ Country è®Šæ•¸å»ºç«‹ä¸‹æ‹‰å¼é¸å–®, åç¨±ç‚º selectinputCountry.
    
    -   å»ºç«‹ Amount è®Šæ•¸, å…¶ä¸­ Amount=Quantity*UnitPrice.

    -   ä½¿ç”¨æ»‘æ¡¿å»ºç«‹ Amount ç¯„åœç¯©é¸, åç¨±ç‚º sliderInputAmount, å…¶çµæœæœƒå½±éŸ¿ "2è³‡æ–™æ˜ç´°" åˆ†é é¢æ¿.

-   server:

    -   åˆ†é é¢ç‰ˆåç¨±: **1è³‡æ–™æ‘˜è¦**, åŠŸèƒ½: é¡¯ç¤ºæ‰€æœ‰è®Šæ•¸ summary çµæœ, åŒ…æ‹¬ Amount è®Šæ•¸.
    
    -   åˆ†é é¢ç‰ˆåç¨±: **2è³‡æ–™æ˜ç´°**, åŠŸèƒ½: é¡¯ç¤ºæ‰€æœ‰54è¬ç­†çµæœ, è€ƒé‡ä½¿ç”¨ DT ç­‰å¥—ä»¶.
    
    -   åˆ†é é¢ç‰ˆåç¨±: **3åœ‹å®¶åˆ¥æ¨ç´åˆ†æè¡¨**, åŠŸèƒ½: å»ºç«‹ä»¥ Country è®Šæ•¸ç‚ºç¾¤çµ„çš„ Amount ç¸½è¨ˆæ–‡å­—æ‘˜è¦, æ¬„ä½åç¨±ç‚º Country, Amount, è³‡æ–™ä¾ Amount æ¬„ä½, ç”±å¤§è‡³å°æ’åˆ—, æŠ€å·§: ä½¿ç”¨ aggregate å‡½æ•¸.
    
    -   åˆ†é é¢ç‰ˆåç¨±: **4åœ‹å®¶åˆ¥æ¨ç´åˆ†æåœ–**, åŠŸèƒ½: å»ºç«‹ä»¥ Country è®Šæ•¸ç‚ºç¾¤çµ„çš„ Amount é•·æ¢åœ–, è³‡æ–™ç”±å¤§è‡³å°æ’åº, è€ƒé‡ä½¿ç”¨ plotly å¥—ä»¶, ui: plotlyOutput, server: renderPlotly.
:::

## 3.6 çµè«–

-   ç†è§£ shinyä½ˆç½®å‡½æ•¸(Layout functions)

-   ç†Ÿæ‚‰ tabsetPanel(åˆ†é é¢ç‰ˆ)

-   ç·´ç¿’ "06_tabsets" ç¯„ä¾‹

-   ç¿’é¡Œ(è§£ç­”...ç¬¬4é›†)

## 

::: {style="text-align: center"}
[THANK YOUğŸ˜ƒ]{style="color: red;"}

-   æŒ‰ è¨‚é–±ã€è®šã€é–‹å•Ÿå°éˆ´éº
-   <a href="https://youtube.com/@alan9956" target="_blank">https://youtube.com/@alan9956</a>
-   <a href="http://rwepa.blogspot.com/" target="_blank">http://rwepa.blogspot.com/</a>

![](images/tail_subscribe) ![](images/tail_rwepa.png) ![](images/tail_lee.png)
:::