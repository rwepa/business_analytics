---
format:
  revealjs: 
    theme: default
    menu: false
    slide-number: true
    code-line-numbers: true
    code-overflow: wrap
    code-block-bg: true
    transition: slide
    transition-speed: slow
editor: visual
---

## RWEPA \| R - shinyä¼æ¥­å¯¦å‹™æ‡‰ç”¨ {background-color="#002060"}

[ç¬¬6é›†-shinyå°æ˜ç®—å‘½å¸«(ä¸‹)-ç¬¬1å­£å®Œçµç¯‡]{style="color: #FFC000; font-size: 1.5em;"}

::: columns
::: {.column width="55%"}
-   æŒ‰ è¨‚é–±ã€è®šã€é–‹å•Ÿå°éˆ´éº
-   <a href="https://youtube.com/@alan9956" target="_blank">https://youtube.com/@alan9956</a>
-   <a href="http://rwepa.blogspot.com/" target="_blank">http://rwepa.blogspot.com/</a> ![](qmd_images/tail_3_icons.png)
:::

::: {.column width="45%"}
Human Resource Teller ![](qmd_images/left_animation_cover.gif)
:::
:::

## å¤§ç¶±

6.1 shinyå°æ˜ç®—å‘½å¸«-å…­å¤§ç‰¹æ€§

6.2 ä¸‹è¼‰æª”æ¡ˆèˆ‡shinyæ¶æ§‹

6.3 uiè¨­å®š

6.4 serverè¨­å®š

6.5 Rmdè¨­å®š

6.6 çµè«–

## 6.1 shinyå°æ˜ç®—å‘½å¸«-å…­å¤§ç‰¹æ€§

::: incremental
1.  æ•´åˆæ•˜è¿°çµ±è¨ˆè³‡æ–™åˆ†æ

2.  æ•´åˆæ¨è«–çµ±è¨ˆè³‡æ–™åˆ†æ

3.  æ•´åˆæ©Ÿå™¨å­¸ç¿’é€²è¡ŒäººåŠ›è³‡æºé æ¸¬

4.  ä¸‹è¼‰å®¢è£½åŒ–HTMLæª”æ¡ˆ

5.  ä¸‹è¼‰å®¢è£½åŒ–WORDæª”æ¡ˆ

6.  è¼•é¬†æ›´æ›ç‚ºä¼æ¥­äººåŠ›è³‡æºæ–™é›†
:::

## è³‡æ–™ç‰¹æ€§

![](qmd_images/01_hr_summary.png)

## è³‡æ–™ç‰¹æ€§(éš±è—å´é‚Š)

![](qmd_images/02_hr_summary_sidebar_hide.png)

## è³‡æ–™æ˜ç´°

![](qmd_images/03_hr_data_view.png)

## ç›¸é—œåˆ†æ

![](qmd_images/04_hr_correlation.png)

## çµ±è¨ˆæª¢å®š

![](qmd_images/05_hr_statistics.png)

## å»ºç«‹æ¨¡å‹

![](qmd_images/06_hr_modeling.png)

## å°æ˜ç®—å‘½å¸«-é æ¸¬æ¨¡å‹

![](qmd_images/07_hr_teller_forecast.png)

## å°æ˜ç®—å‘½å¸«-å ±è¡¨ä¸‹è¼‰

![](qmd_images/08_hr_teller_report.png)

## å°æ˜ç®—å‘½å¸«-HTMLå ±è¡¨ä¸‹è¼‰

![](qmd_images/09_hr_teller_report_html.png)

## å°æ˜ç®—å‘½å¸«-WORDå ±è¡¨ä¸‹è¼‰

![](qmd_images/10_hr_teller_report_docx.png)

## 6.2 ä¸‹è¼‰æª”æ¡ˆèˆ‡shinyæ¶æ§‹ {.smaller}

-   ä¸‹è¼‰shiny å°æ˜ç®—å‘½å¸« app

-   <a href="https://github.com/rwepa/business_analytics/tree/main/r-shiny-06-hr-teller" target="_blank">https://github.com/rwepa/business_analytics/tree/main/r-shiny-06-hr-teller</a>

-   shiny app æ¶æ§‹

![](qmd_images/shiny_code.png)

## shinydashboard å¥—ä»¶ - uiæ¶æ§‹

![](qmd_images/ui_structure.png)

## 6.3 uiç¨‹å¼ç¢¼

``` r
ui <- dashboardPage(
  dashboardHeader(title = "RWEPA | shinyå°æ˜ç®—å‘½å¸«-v23.03.25, http://rwepa.blogspot.com/", 
                  titleWidth = 750),
  dashboardSidebar(
    sidebarMenu(
      menuItem(text="è³‡æ–™ç‰¹æ€§", tabName = "datasummary", icon = icon("sunglasses", lib = "glyphicon")),
      menuItem(text="è³‡æ–™æ˜ç´°", tabName = "dataview", icon = icon("list", lib = "glyphicon")),
      ...
    )
  ),
  
  dashboardBody(
    tabItems(
      tabItem(tabName = "datasummary",
              
              fluidRow(
                box(
                  title = "è³‡æ–™æ‘˜è¦",
                  solidHeader = TRUE,
                  width = 12,
                  collapsible = TRUE,
                  verbatimTextOutput("Summary"),
                ),
              
                box(
                  title = "è³‡æ–™çµæ§‹",
                  ...
                )
              )
      ),
      tabItem(
      ),
      ...
    ) # end for tabItems
  ) # end for dashboardBody
) # end for ui
```

## 6.4 serverè¨­å®š

-   è¼‰å…¥åœ–ç‰‡ - renderImageå‡½æ•¸

-   HTMLä¸‹è¼‰ - downloadHandlerå‡½æ•¸

## è¼‰å…¥åœ–ç‰‡ - renderImageå‡½æ•¸

::: columns
::: {.column width="65%"}
-   ä½¿ç”¨ renderImage å‡½æ•¸

-   ä½¿ç”¨ list å‚³éåœ–ç‰‡ç‰©ä»¶

```{r}
#| eval: false
#| echo: true
output$left_prediction <- renderImage({
    list(src = "qmd_images/left_animation.gif",
         contentType = "image/gif")
  }, deleteFile = FALSE)
```
:::

::: {.column width="35%"}
![](qmd_images/left_animation.gif)
:::
:::

## HTMLä¸‹è¼‰ - downloadHandlerå‡½æ•¸

```{r}
#| eval: false
#| echo: true
#| code-line-numbers: "2|5-7|10|19-22"
# HTMLä¸‹è¼‰
output$download_report_html <- downloadHandler({
  content = function(file) {
    
      # è¤‡è£½ Rmd è‡³æš«å­˜è³‡æ–™å¤¾
      tempReport <- file.path(tempdir(), "hr_teller_report_html.Rmd")
      file.copy("data/hr_teller_report_html.Rmd", tempReport, overwrite = TRUE)
      
      # è¨­å®šåƒæ•¸(params)ä¸¦å‚³è¼¸è‡³ Rmdæ–‡ä»¶, åƒæ•¸ä½¿ç”¨ listè³‡æ–™ç‰©ä»¶.
      params <- list(para_title         = input$hr_title, 
                     para_producer      = input$hr_producer, 
                     para_headdata      = input$hr_headdata, 
                     para_str           = input$hr_str,
                     para_evaluation    = input$hr_evaluation,
                     ...,
                     para_prediction    = hr_prediction)
      
      # ç·¨è­¯(Knit)æ–‡ä»¶, å‚³éåƒæ•¸ä¸²åˆ—(params list)ä¸¦è©•ä¼°å…¶çµæœ.
      rmarkdown::render(tempReport, 
                        output_file = file,
                        params = params,
                        envir = new.env(parent = globalenv())
      )
    }
})
```

## 6.5 Rmdè¨­å®š {.smaller}

-   HTML Rmdæª”æ¡ˆ

    -   æª”å: hr_teller_report_html.Rmd, è¼¸å‡º: output: [html_document]{style="color: red;"}

-   WORD docxæª”æ¡ˆ: hr_teller_report_docx.Rmd

    -   æª”å: hr_teller_report_docx.Rmd, è¼¸å‡º: output: [word_document]{style="color: red;"}

```{r}
#| eval: false
#| echo: true
---
output: html_document
params:
  para_title: NA
  para_producer: NA
  para_headdata: NA
  para_str: NA
  para_evaluation: NA
  para_project: NA
  para_hours: NA
  para_company: NA
  para_satisfication: NA
  para_accident: NA
  para_promotion: NA
  para_role: NA
  para_salary: NA
  para_prediction: NA
---

# ä¸»é¡Œ: `r params$para_title`
# è£½è¡¨: `r params$para_producer`
```

## 6.6 çµè«–

-   ç†Ÿæ‚‰ shiny, shinydashboard äº’å‹•å¼è³‡æ–™åˆ†æå¥—ä»¶

-   ç†Ÿæ‚‰ readr, dplyr, ggcorrplot, ggplot2, randomForest, caret, pROC å¥—ä»¶

-   æä¾›`shinyéŠ·å”®å„€è¡¨æ¿`è¦åŠƒèˆ‡è£½ä½œæµç¨‹

-   æä¾›`shinyäººåŠ›è³‡æºå„€è¡¨æ¿`è¦åŠƒèˆ‡è£½ä½œæµç¨‹

-   Rèˆ‡å°æ˜ç®—å‘½å¸«(ä¸‹) ...ç¬¬1å­£å®Œçµç¯‡

## 

::: {style="text-align: center"}
[THANK YOUğŸ˜ƒ]{style="color: red;"}

-   æŒ‰ è¨‚é–±ğŸ›’ã€è®šğŸ‘‹ã€é–‹å•Ÿå°éˆ´éºğŸ””
-   <a href="https://youtube.com/@alan9956" target="_blank">https://youtube.com/@alan9956</a>
-   <a href="http://rwepa.blogspot.com/" target="_blank">http://rwepa.blogspot.com/</a>

![](qmd_images/tail_subscribe) ![](qmd_images/tail_rwepa.png) ![](qmd_images/tail_lee.png)

![](qmd_images/thanks.gif)
:::
